// Содержимое файла adblock_script.js
(function() {

    function showNotificationUntilClick(message, type = 'success') {
        if (!document.body) {
            return;
        }

        const notification = document.createElement('div');
        notification.textContent = message.replace(/\\n/g, '\n');

        const baseStyles = {
            position: 'fixed',
            bottom: '20px',
            left: '50%',
            transform: 'translateX(-50%)',
            minWidth: '180px',
            maxWidth: '90%',
            padding: '12px 20px',
            color: 'white',
            borderRadius: '25px',
            boxShadow: '0 3px 8px rgba(0, 0, 0, 0.25)',
            zIndex: '10001',
            fontFamily: 'Roboto, Arial, sans-serif',
            fontSize: '14px',
            lineHeight: '1.4',
            textAlign: 'center',
            whiteSpace: 'pre-wrap',
            opacity: '0',
            transition: 'opacity 0.4s ease-in-out, bottom 0.4s ease-in-out',
            cursor: 'default'
        };

        let backgroundColor = '#333'; let color = 'white';
        switch (type) {
            case 'success': backgroundColor = '#28a745'; break;
            case 'info':    backgroundColor = '#17a2b8'; break;
            case 'warning': backgroundColor = '#ffc107'; color = '#333'; break;
            case 'error':   backgroundColor = '#dc3545'; break;
        }
        baseStyles.backgroundColor = backgroundColor; baseStyles.color = color;
        Object.assign(notification.style, baseStyles);

        let isDismissing = false;

        const dismissNotification = () => {
            if (isDismissing) return;
            isDismissing = true;

            document.removeEventListener('click', dismissNotification, { capture: true });
            document.removeEventListener('touchstart', dismissNotification, { capture: true });

            notification.style.opacity = '0';
            notification.style.bottom = '10px';
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 400);
        };

        document.body.appendChild(notification);

        setTimeout(() => {
            notification.style.opacity = '1';
            notification.style.bottom = '30px';
            document.addEventListener('click', dismissNotification, { once: true, capture: true });
            document.addEventListener('touchstart', dismissNotification, { once: true, capture: true });
        }, 50);
    }

    showNotificationUntilClick('Patch Activated v0.1b\n@xrsrvd', 'success');

    let lastFoundAd = null;

    function scanForAds() {
        const closeButtons = Array.from(document.querySelectorAll('div[class*="closeButtonWrapper"]'));
        closeButtons.forEach(button => {
            if (button === lastFoundAd || button.hasAttribute('data-detected')) {
                return;
            }
            button.setAttribute('data-detected', 'true');
            lastFoundAd = button;
            let adContainer = button;
            for (let i = 0; i < 3; i++) {
                if (adContainer.parentElement) {
                    adContainer = adContainer.parentElement;
                }
            }
            adContainer.style.display = 'none';
        });
    }

    setInterval(scanForAds, 1000);

})();
