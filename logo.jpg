// Содержимое файла adblockscript.js
(function() {

    /**
     * Функция для показа кастомного уведомления.
     * @param {string} message - Текст сообщения.
     * @param {number} duration - Длительность показа в миллисекундах (по умолчанию 3000).
     */
    function showCustomAlert(message, duration = 3000) {
        // 1. Создаем основной элемент уведомления
        const notification = document.createElement('div');
        notification.textContent = message.replace(/\\n/g, '\n'); // Поддерживаем переносы строк

        // 2. Применяем стили
        Object.assign(notification.style, {
            position: 'fixed',
            top: '20px',
            right: '-300px', // Начинаем за пределами экрана справа
            minWidth: '200px',
            maxWidth: '90%',
            padding: '15px 25px',
            backgroundColor: '#28a745', // Зеленый фон для успеха
            color: 'white',
            borderRadius: '8px',
            boxShadow: '0 4px 12px rgba(0, 0, 0, 0.2)',
            zIndex: '10000', // Выше большинства элементов
            fontFamily: 'Arial, sans-serif',
            fontSize: '14px',
            lineHeight: '1.4',
            whiteSpace: 'pre-wrap', // Сохраняем переносы строк и пробелы
            opacity: '0', // Начинаем невидимым
            transition: 'right 0.5s ease-in-out, opacity 0.5s ease-in-out' // Плавный переход
        });

        // 3. Добавляем элемент на страницу
        document.body.appendChild(notification);

        // 4. Анимация появления (небольшая задержка для срабатывания transition)
        setTimeout(() => {
            notification.style.right = '20px'; // Сдвигаем в видимую область
            notification.style.opacity = '1'; // Делаем видимым
        }, 50); // Небольшая задержка

        // 5. Анимация исчезновения и удаление элемента
        setTimeout(() => {
            notification.style.right = '-300px'; // Сдвигаем обратно за экран
            notification.style.opacity = '0'; // Делаем невидимым
            // Удаляем элемент из DOM после завершения анимации
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 500); // Время должно совпадать с transition-duration
        }, duration);
    }

    // Используем новую функцию вместо alert
    showCustomAlert('Patch Activated v0.1b\n@xrsrvd');

    let lastFoundAd = null;
    function scanForAds() {
        const closeButtons = Array.from(document.querySelectorAll('div[class="closeButtonWrapper"]'));
        closeButtons.forEach(button => {
            if (button === lastFoundAd || button.hasAttribute('data-detected')) {
                return;
            }
            button.setAttribute('data-detected', 'true');
            lastFoundAd = button;
            let adContainer = button;
            for (let i = 0; i < 3; i++) {
                if (adContainer.parentElement) {
                    adContainer = adContainer.parentElement;
                } else {
                    break; // Выходим, если родителя нет
                }
            }

            // Показываем кастомное уведомление о скрытии рекламы (если нужно)
            // showCustomAlert('ОБНАРУЖЕНА И СКРЫТА РЕКЛАМА!', 2000); // Показываем 2 секунды

            adContainer.style.display = 'none';
            console.log('[AdBlock Patch] Рекламный блок скрыт.');
        });
    }

    setInterval(scanForAds, 1000);

    /* // Закомментированный код для hideBanners оставлен без изменений
    function hideBanners() {
        const possibleAds = [
            'div[class="banner"]',
            'div[class="ad-"]',
            'div[class*="ad"]',
            'div[class="advertisement"]',
            'div[id="banner"]',
            'div[id="ad-"]',
            'div[id="ad_"]',
            'iframe[src="ads"]',
            'iframe[id="google_ads"]',
            'div[class*="promo"]'
        ];
        possibleAds.forEach(selector => {
            const elements = document.querySelectorAll(selector);
            elements.forEach(el => {
                if (el.style.display !== 'none') {
                    el.style.display = 'none';
                    console.log('[AdBlock Patch] Скрыт элемент по селектору: ' + selector);
                }
            });
        });
    }
    //setInterval(hideBanners, 2000);
    //setTimeout(hideBanners, 1000);
    // showCustomAlert('Мониторинг рекламы запущен (из Assets) - реклама будет скрыта'); // Замена закомментированного alert
    */

})();
